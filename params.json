{"name":"HIDSimpleFramework","tagline":"Simple USB-HID framework","body":"### HIDSimpleFrameworkについて\r\nHIDSimpleFrameworkはUSB HIDを用いてホスト（PC）とマイコンのプログラムを連携させる、非常にシンプルなフレームワークです。\r\nできることは限られていますが、USB HIDなのでドライバが不要、また、CDCデバイスのようにCOMポートを選択する必要もありません。\r\nホスト側のライブラリはC#で書かれており、.NET frameworkさえインストールされていれば、Windows XP～Windows 8まで幅広い環境で確実に動作します。\r\n\r\n### 最も簡単な使い方\r\nPCと接続して、ホスト（PC）からの指令でLEDを点滅させる簡単なサンプルは以下のようになります。\r\n64バイトのパケットにデータを入れてホストから送信し、それをマイコンで受信する、単純な動作です。マイコン側は、LEDのポートの初期化と簡単なループ以外になにも書く必要がありません。\r\n\r\nデバイス（マイコン）側のコード：\r\n```\r\nvoid init( void ) {\r\n\tTRISBbits.TRISB1 = 0;\t// RB1をデジタル出力に設定\r\n}\r\n\r\nvoid run( void ) {\r\n\tBYTE buff[64];\t// 受信バッファ\r\n\r\n\t// データが届いていたら受信する\r\n\tif ( HIDReceive( buff, sizeof( buff ) ) ) {\r\n\t\t// LEDを点けるか消すか\r\n\t\tLATBbits.LATB1 = ( buff[0] ? 1 : 0 );\r\n\t}\r\n}\r\n```\r\n\r\nホスト（ＰＣ）側のコード：\r\n```\r\n// デバイスに接続\r\nHIDSimple dev = new HIDSimple();\r\ndev.Open( vid, pid );\r\nwhile ( true ) {\r\n\t// １を送信\r\n\tdev.Send( new byte[] { 1 } );\r\n\tSystem.Threading.Thread.Sleep( 500 );\r\n\t// ０を送信\r\n\tdev.Send( new byte[] { 0 } );\r\n\tSystem.Threading.Thread.Sleep( 500 );\r\n}\r\n```\r\n\r\n### もう少し実用的な使い方\r\n一方的にホストから指令を送るだけではあまり使えないので、ボタンを押したらLEDが光るサンプルを作ってみます。\r\nマイコンに接続されたボタンの状態をホスト側で読み取り、LEDを点灯させる指令をマイコンに送信します。\r\n\r\nデバイス（マイコン）側のコード：\r\n```\r\nvoid init( void ) {\r\n\tANSELBbits.ANSB0 = 0;\t// RB0をデジタル入力に設定\r\n\tTRISBbits.TRISB0 = 1;\r\n\r\n\tTRISBbits.TRISB1 = 0;\t// RB1をデジタル出力に設定\r\n}\r\n\r\nvoid run( void ) {\r\n\tBYTE buff[64];\t// 受信バッファ\r\n\r\n\t// データが届いていたら受信する\r\n\tif ( HIDReceive( buff, sizeof( buff ) ) ) {\r\n\t\t// LEDを点けるか消すか\r\n\t\tLATBbits.LATB1 = ( buff[0] ? 1 : 0 );\r\n\t}\r\n\t// 送信可能？\r\n\tif ( HIDSendReady() ) {\r\n\t\t// ボタンの状態を送る\r\n\t\tbuff[0] = PORTBbits.RB0;\r\n\t\tHIDSend( buff, 1 );\r\n\t}\r\n}\r\n```\r\n\r\nホスト（ＰＣ）側のコード：\r\n```\r\n// デバイスに接続\r\nHIDSimple dev = new HIDSimple();\r\ndev.Open( vid, pid );\r\nwhile ( true ) {\r\n\t// 受信する\r\n\tbyte[] buff = dev.Receive();\r\n\t// そのまま送り返す\r\n\tdev.Send( buff );\r\n\tSystem.Threading.Thread.Sleep( 100 );\r\n}\r\n```\r\n\r\n### お約束\r\nこのライブラリは三条項BSDライセンスとなっています。\r\nまったく自由にお使い下さい。但し特に保証もしません。\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}